// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model ContactSubmission {
  id      String  @id @default(uuid()) @db.Uuid
  name    String
  email   String
  subject String
  message String
  read    Boolean @default(false)

  createdAt DateTime @default(now()) @db.Timestamptz()

  @@map("contact_submissions")
}

model Portfolio {
  id         String @id @default(uuid()) @db.Uuid
  title      String
  summary    String
  body       String
  websiteUrl String

  categories CategoriesOnPortfolios[]

  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @updatedAt @db.Timestamptz()

  @@map("portfolios")
}

model PortfolioCategory {
  id          String @id
  description String

  portfolios CategoriesOnPortfolios[]

  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @updatedAt @db.Timestamptz()

  @@map("portfolio_categories")
}

model CategoriesOnPortfolios {
  portfolio   Portfolio         @relation(fields: [portfolioId], references: [id])
  portfolioId String            @db.Uuid
  category    PortfolioCategory @relation(fields: [categoryId], references: [id])
  categoryId  String

  assignedAt DateTime @default(now())

  @@id([portfolioId, categoryId])
  @@index([categoryId, portfolioId])
  @@map("categories_on_portfolios")
}

model Blog {
  id      String @id @default(uuid()) @db.Uuid
  title   String
  summary String
  body    String

  categories CategoriesOnBlogs[]

  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @updatedAt @db.Timestamptz()

  @@map("blogs")
}

model BlogCategory {
  id          String @id
  description String

  blogs CategoriesOnBlogs[]

  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @updatedAt @db.Timestamptz()

  @@map("blog_categories")
}

model CategoriesOnBlogs {
  blog       Blog         @relation(fields: [blogId], references: [id])
  blogId     String       @db.Uuid
  category   BlogCategory @relation(fields: [categoryId], references: [id])
  categoryId String

  assignedAt DateTime @default(now())

  @@id([blogId, categoryId])
  @@index([categoryId, blogId])
  @@map("categories_on_blogs")
}
